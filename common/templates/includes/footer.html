{% load static %}

<script src="{% static 'assets/js/vendor-all.min.js' %}"></script>
<script src="{% static 'assets/plugins/bootstrap/js/popper.min.js' %}"></script>
<script src="{% static 'assets/plugins/bootstrap/js/bootstrap.bundle.min.js' %}"></script>
<script src="{% static 'assets/js/pcoded.min.js' %}"></script>

<script src="{% static 'assets/js/vendor-all.min.js' %}"></script>
<script src="{% static 'assets/plugins/chart-am4/js/core.js' %}"></script>
<script src="{% static 'assets/plugins/chart-am4/js/charts.js' %}"></script>
<script src="{% static 'assets/plugins/chart-am4/js/animated.js' %}"></script>
<script src="{% static 'assets/js/pages/dashboard-project.js' %}"></script>

<!-- typeahead -->
<script src="{% static 'assets/js/plugins/typeahead.bundle.min.js' %}"></script>

<!-- datefilter -->

<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" />



<!-- <script src="{% static 'assets/js/menu-setting.js' %}"></script> -->
<style>
    
		.wrap-text {
    white-space: normal !important;
    word-wrap: break-word; 
    word-break: break-word;
    max-width: 250px; /* Adjust width as needed */
}

</style>
<script>
    $('#exampleModal').on('show.bs.modal', function (event) {
        var button = $(event.relatedTarget)
        var recipient = button.data('whatever')
        var modal = $(this)
        modal.find('.modal-title').text('New message to ' + recipient)
        modal.find('.modal-body input').val(recipient)
    })
</script>


<script src="{% static 'assets/plugins/data-tables/js/datatables.min.js' %}"></script>

<script src="{% static 'assets/plugins/data-tables/js/dataTables.select.min.js' %}"></script>
<script src="{% static 'assets/js/pages/data-select-custom.js' %}"></script>


<script src="https://cdn.datatables.net/select/1.3.1/js/dataTables.select.min.js"></script>

<script src="{% static 'assets/plugins/data-tables/js/buttons.colVis.min.js' %}"></script>

<script src="{% static 'assets/js/pages/data-export-custom.js' %}"></script>


<script src="{% static 'assets/js/pages/data-api-custom.js' %}"></script>


<script src="{% static 'assets/js/pages/data-styling-custom.js' %}"></script>

<!-- dashboard-custom js -->
<script src="{% static 'assets/js/pages/dashboard-analytics.js' %}"></script>


<!-- select2 Js -->
<script src="{% static 'assets/plugins/select2/js/select2.min.js' %}"></script>

<script src="{% static 'assets/plugins/fullcalendar/js/lib/moment.min.js' %}"></script>
<script src="{% static 'assets/plugins/fullcalendar/js/lib/jquery-ui.min.js' %}"></script>
<script src="{% static 'assets/plugins/fullcalendar/js/fullcalendar.min.js' %}"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.0/dist/sweetalert2.all.min.js"></script>
 
<script src="{% static 'assets/plugins/input-tags/js/tagsinput.js' %}"></script>


<script>
    $('.select2').select2({
        dropdownParent: $('#edit_modal')
    });


    function formatINR(amount) {
    return new Intl.NumberFormat('en-IN', { 
        style: 'currency', 
        currency: 'INR' 
    }).format(amount);
}



</script>
<script>
    function validateDecimal3(input) {
        let value = input.value;
        
        // Allow only numbers with up to 3 decimal places
        let validValue = value.match(/^\d+(\.\d{0,3})?$/); 
        
        if (!validValue) {
            input.value = value.slice(0, -1); // Remove last invalid character
        }
    }

    function validateDecimal2(input) {
        let value = input.value;
        
        // Allow only numbers with up to 3 decimal places
        let validValue = value.match(/^\d+(\.\d{0,2})?$/);
        
        if (!validValue) {
            input.value = value.slice(0, -1); // Remove last invalid character
        }
    }

    function validatePositive(input) {
    if (input.value < 0) {
        input.value = '';
        alert("Value cannot be negative!");
    }
}
    </script>

<!-- <script type="text/javascript">
    $(document).ready(function() {
        jQuery.extend(jQuery.fn.dataTableExt.oSort, {
            "date-uk-pre": function(a) {
                var ukDatea = a.split('-');
                return (ukDatea[2] + ukDatea[1] + ukDatea[0]) * 1;
            },
    
            "date-uk-asc": function(a, b) {
                return (a < b) ? -1 : ((a > b) ? 1 : 0);
            },
    
            "date-uk-desc": function(a, b) {
                return (a < b) ? 1 : ((a > b) ? -1 : 0);
            }
        });
    });
</script> -->

<script type="text/javascript">
    $(document).ready(function () {
        // Define custom sorting for UK-style dates (DD-MM-YYYY)
        jQuery.extend(jQuery.fn.dataTableExt.oSort, {
            "date-uk-pre": function (a) {
                // Check for empty or null values
                if (!a || a.trim() === '') {
                    return 0;
                }

                // Split date into components
                var ukDate = a.split('-');
                // Parse as YYYYMMDD for sorting
                return Date.parse(`${ukDate[2]}-${ukDate[1]}-${ukDate[0]}`) || 0;
            },
            "date-uk-asc": function (a, b) {
                return a - b;
            },
            "date-uk-desc": function (a, b) {
                return b - a;
            }
        });
    });
</script>


<script>
$(document).ready(function () {
    $('input[type="date"]').on('blur keydown', function (e) {
        const input = $(this);
        const dateVal = input.val();

        // Only trigger on Enter key or blur
        if (e.type === 'keydown' && e.key !== 'Enter') return;

        // Proceed only if full date is entered (10 characters in yyyy-mm-dd format)
        if (dateVal && dateVal.length === 10) {
            const selectedDate = new Date(dateVal);
            const today = new Date();

            // Financial year starts on April 1
            const fyStart = new Date(today.getMonth() < 3 ? today.getFullYear() - 1 : today.getFullYear(), 3, 1);
            const fyEnd = new Date(today.getMonth() < 3 ? today.getFullYear() : today.getFullYear() + 1, 2, 31);

            if (selectedDate < fyStart || selectedDate > fyEnd) {
                    notifier.show(
                        'Restricted!',
                        ' Date must be within the current financial year',
                        // \n${fyStart.toLocaleDateString()} to ${fyEnd.toLocaleDateString()}',
                        'error',
                        "{% static 'assets/images/notification/high_priority-48.png' %}",
                        4000
                    );


                // alert(`‚ùå Date must be within the current financial year:\n${fyStart.toLocaleDateString()} to ${fyEnd.toLocaleDateString()}`);
                input.val('');
                input.focus();
            }
        }
    });
});
</script>

<!-- daterangepicker -->

<!-- notification Js -->
<script src="{% static 'assets/js/plugins/notifier.js' %}"></script>
<script src="{% static 'assets/js/pages/ac-notification.js' %}"></script>


<script src="http://momentjs.com/downloads/moment-with-locales.min.js"></script>




<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>



<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/daterangepicker/
    daterangepicker.css" />




<div class="footer-fab">    
    <div class="fab-hover">
        <ul class="list-unstyled">
            <li><a href="../doc/index-bc-package.html" target="_blank" data-text="UI Kit" class="btn btn-icon btn-rounded btn-info m-0"><i class="feather icon-layers"></i></a></li>
            <li><a href="/admin" target="_blank" data-text="Document" class="btn btn-icon btn-rounded btn-primary m-0"><i class="feather icon feather icon-book"></i></a></li>
        </ul>
    </div>
</div>
<script>


    
// $("#add_form").submit(function (e) {
//         e.preventDefault();
//         $.ajax({
//             type: 'POST',
//             url: '/bag-add/',
//             data: $(this).serialize(),
//             success: function (response) {
//                 if (response.data === 'Success') {
//                     notifier.show(
//                     'Well Done!', 
//                     'Bag details added successfully.', 
//                     'success', 
//                     "{% static 'assets/images/notification/ok-48.png' %}", 
//                     4000
//                 ); 
//                     $('#bag_modal').modal('hide'); 
 
//                     $('#add_form').trigger('reset'); 
//                     refresh_data(); 
//                 } else {
//                     notifier.show(
//               'Error!', 
//               'Failed to add Bag details.', 
//               'danger', 
//               "{% static 'assets/images/notification/high_priority-48.png' %}", 
//               4000
//           );                }
//             },
//             error: function(xhr, status, error) {
//                 sweetalert('error', 'Failed to add Bag. An error occurred.'); 
//             }
//         });
//     });
 
 


</script>

<!-- <script>
    function googleLoginEndpoint(googleUser) {
        console.log(googleUser);
    
        var ajax = new XMLHttpRequest();
        ajax.open("POST", "/auth_verify/", true);
        ajax.onreadystatechange = function () {
            if (this.readyState == 4) {
                if (this.status == 200) {
                    if (this.responseText == 'logged_in') {
                        location.reload();
                    }
                }
                if (this.status == 500) {
                    console.error(this.responseText);
                }
            }
        };
    
        var formData = new FormData();
        formData.append("id_token", googleUser.credential);
        formData.append("u_data", JSON.stringify(parseJwt(googleUser.credential)));
        ajax.send(formData);
    }
    
    function parseJwt(token) { 
       var base64Url = token.split('.')[1];
       var base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
       var jsonPayload = decodeURIComponent(atob(base64).split('').map(function(c) {
           return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
       }).join(''));
    
       return JSON.parse(jsonPayload);
    }
</script> -->
<script type="text/javascript">
      
    jQuery.extend( jQuery.fn.dataTableExt.oSort, {
        "date-uk-pre": function ( a ) {
        var ukDatea = a.split('-');
        return (ukDatea[2] + ukDatea[1] + ukDatea[0]) * 1;
    },

    "date-uk-asc": function ( a, b ) {
        return ((a < b) ? -1 : ((a > b) ? 1 : 0));
    },

    "date-uk-desc": function ( a, b ) {
        return ((a < b) ? 1 : ((a > b) ? -1 : 0));
    }
    } );



    
// ```````````````````````````````````` TYPEAHEAD ````````````````````````````````````````````````````


$(function () {
        $.ajax({
            url: '/fabric-names/',  // Adjust this if your URL has a prefix
            type: 'GET',
            dataType: 'json',
            success: function (data) {
                var fabricNames = data.fabric_names || [];

                var substringMatcher = function (strs) {
                    return function findMatches(q, cb) {
                        var matches = [];
                        var substrRegex = new RegExp(q, 'i');

                        $.each(strs, function (i, str) {
                            if (substrRegex.test(str)) {
                                matches.push(str);
                            }
                        });

                        cb(matches);
                    };
                };

                $('#fabricName , #fabricName').typeahead({
                    hint: true,
                    highlight: true,
                    minLength: 1
                }, {
                    name: 'fabricNames',
                    source: substringMatcher(fabricNames)
                });
            },
            error: function () {
                console.error('Failed to fetch fabric names');
            }
        });
    });

    

// ``````````````````` end Typeahead ``````````````````````````````````````````
  </script>
</body>

</html>