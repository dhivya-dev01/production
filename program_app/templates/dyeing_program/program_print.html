{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>MIRRA GARMENTS - DYEING PROGRAM</title>

    <!-- Bootstrap -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"
          integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u"
          crossorigin="anonymous">

    <!-- Normalize -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/7.0.0/normalize.min.css">

    <!-- Fonts -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Roboto&display=swap');
    </style>

    <!-- Print Styles for A4 -->
    <!-- <style>
        @page {
            size: A4;
            margin: 20mm;
        }

        body {
            position: relative;
            width: 21cm;
            height: 29.7cm;
            margin: 0 auto;
            color: #001028;
            background: #FFFFFF;
            font-family: Roboto, Arial, sans-serif;
            font-size: 13pt;
        }

        .clearfix:after {
            content: "";
            display: table;
            clear: both;
        }

        header {
            padding: 10px 0;
            margin-bottom: 30px;
        }

        #logo {
            text-align: center;
            margin-bottom: 10px;
        }

        #logo img {
            width: 90px;
        }

        /* a {
            color: black;
            text-decoration: none;
            font-size: 8pt;
        } 

        h1 {
            font-size: 13.5pt;
            font-weight: bold;
        }

        h4 {
            font-size: 11pt;
            font-weight: bold;
        }

        p {
            font-size: 12pt;
            margin: 0pt;
        } */



          * {margin:0; padding:0; text-indent:0; }
         a { color: black; font-family:Roboto, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 11pt; }
         h1 { color: black; font-family:Roboto, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 13.5pt; }
         h4 { color: black; font-family:Roboto, sans-serif; font-style: normal; font-weight: bold; text-decoration: none; font-size: 11pt; }
         p { color: black; font-family:Roboto, sans-serif; font-style: normal; font-weight: normal; text-decoration: none; font-size: 11pt; margin:0pt; }
         
		 
		 .table>tbody>tr>td, .table>tbody>tr>th, .table>tfoot>tr>td, .table>tfoot>tr>th, .table>thead>tr>td, .table>thead>tr>th{
			padding: 4px;
			
		}
    </style> -->

       
<style>
  /* @import url('https://fonts.googleapis.com/css2?family=Roboto&display=swap'); */

  @page {
    size: A4 landscape;
    margin: 1cm; /* You can adjust margin as needed */
  }

  .clearfix:after {
    content: "";
    display: table;
    clear: both;
  }

  body {
    position: relative;
    width: 29.7cm;  /* A4 landscape width */
    height: 21cm;   /* A4 landscape height */
    margin: 0 auto;
    padding: 1cm;
    color: #001028;
    background: #FFFFFF;
    font-family: Roboto, Arial, sans-serif;
    font-size: 12px;
  }

  header {
    padding: 10px 0;
    margin-bottom: 30px;
  }

  #logo {
    text-align: center;
    margin-bottom: 10px;
  }

  #logo img {
    width: 90px;
  }

  * {
    margin: 0;
    padding: 0;
    text-indent: 0;
  }

  a {
    color: black;
    font-family: Roboto, sans-serif;
    font-size: 10pt;
    text-decoration: none;
  }

  h1 {
    color: black;
    font-family: Roboto, sans-serif;
    font-size: 13.5pt;
    font-weight: bold;
  }

  h4 { 
    color: black;
    font-family: Roboto, sans-serif;
    font-size: 11pt;
    font-weight: bold;
  }

  p {
    color: black;
    font-family: Roboto, sans-serif;
    font-size: 10pt;
    margin: 0pt;
  }

  .table > tbody > tr > td,
  .table > tbody > tr > th,
  .table > tfoot > tr > td,
  .table > tfoot > tr > th,
  .table > thead > tr > td,
  .table > thead > tr > th {
    padding: 4px;
  }
</style>
</head> 
 
<body>
<section class="sheet" style="padding: 20px">

    <table width="100%" border="0" cellspacing="0" cellpadding="0">
        <tr>
            <td width="35%" style="vertical-align: top;">
                <img width="140" height="70" src="{{ image_url }}"/>
            </td>
            <td width="65%" align="right">
                <h4><big><b><strong>{{ company.name.upper }}</strong></b></big></h4>
                <div style="margin-top: -6px;">
                    <p>#73 Devji Colony, B.S. Sundaram Road, Tirupur-641604</p>
                    <p><b>Cell:</b> {{ company.mobile }} | <b>Phone:</b> {{ company.phone }}</p>
                    <p><b>Email:</b> {{ company.email }}</p>
                    <p><b>GSTIN:</b> {{ company.gstin }} </p>
                </div>
            </td>
        </tr>
    </table>

    <hr style="margin-top:6px;margin-bottom:6px">

    <table width="100%" border="0" cellspacing="0" cellpadding="0">
        <tbody>
        <tr>
            <td align="left">
                <p><strong>PROGRAM No. : {{ total_values.program_no }}</strong></p>
            </td>
            <td align="center">
                <div class="border-box"
                     style="width: 140px;border:2px solid black;text-align:center;padding: 3px;">
                    <p><strong>DYEING PROGRAM</strong></p>
                </div>
            </td>
            <td align="right">
                <p><strong>PROGRAM Date: {{ total_values.program_date|date:"d-m-Y" }}</strong></p>
            </td>
        </tr>
        </tbody>
    </table>

<table class="table table-striped table-bordered">
    <tbody>
    <tr>
        <td colspan="{{ total_columns }}" style="text-align: center;">
            <strong>{{ total_values.name }}</strong>
        </td>
    </tr>

    <tr>
        <td><strong>Fabric</strong></td>
        <td><strong>Color</strong></td>
        {% for dia in dias %}
            <td colspan="2" style="text-align: center;"><strong>{{ dia }}</strong></td>
        {% endfor %}
        <td colspan="2" style="text-align: center;"><strong> Total</strong></td>
    </tr>
    <tr>
        <td></td>
        <td></td>
        {% for dia in dias %}
            <td style="text-align: center;"><strong>Roll</strong></td>
            <td style="text-align: center;"><strong>Weight</strong></td>
        {% endfor %}
        <td style="text-align: center;"><strong>Roll</strong></td>
        <td style="text-align: center;"><strong>Weight</strong></td>
    </tr>

    {% for row in grouped_data %}
        <tr>
            <td>{{ row.fabric }}</td>
            <td>{{ row.color }}</td>
            {% for entry in row.dia_data_list %}
                {% if entry.roll %}
                    <td align="center">{{ entry.roll }}</td>
                    <td align="center">{{ entry.roll_wt|floatformat:2 }}</td>
                {% else %}
                    <td align="center">-</td>
                    <td align="center">-</td>
                {% endif %}
            {% endfor %}
            <td align="center"><strong>{{ row.row_total_roll }}</strong></td>
            <td align="center"><strong>{{ row.row_total_weight|floatformat:2 }}</strong></td>
        </tr>
    {% endfor %}
    </tbody>

    <tfoot>
    <tr>
        <td colspan="2" align="right"><strong>Total</strong></td>
        {% for total in dia_totals_list %}
            <td align="center"><strong>{{ total.roll }}</strong></td>
            <td align="center"><strong>{{ total.roll_wt|floatformat:2 }}</strong></td>
        {% endfor %}
        <td align="center"><strong>{{ grand_total_roll }}</strong></td>
        <td align="center"><strong>{{ grand_total_weight|floatformat:2 }}</strong></td>
    </tr>
    </tfoot>
</table>



    <table width="100%" border="0" cellspacing="0" cellpadding="0">
        <tr>
            <td align="left"></td>
            <td align="right">
                <p><strong>For MIRRA GARMENTS PVT LTD</strong></p>
            </td>
        </tr>

        <tr>
            <td colspan="2"><br><br></td>
        </tr>

        <tr>
            <td></td>
            <td align="right">
                <p><strong>Authorized Signature</strong></p>
            </td>
        </tr>
    </table>

</section>
</body>
</html>
